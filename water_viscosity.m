function mu = water_viscosity(T, rho)

% Dynamic visosity of pure water in [Pa s]
% Input temperature is in Kelvin and density in [kg/m^3]

T = T / 647.096;
rho = rho / 322;

i = [0 1 2 3]';
H = [1.67752 2.20462 0.6366564 -0.241605]';

mu_0 = 100 * sqrt(T) / sum(H ./ T.^i);

i = [0 1 2 3 0 1 2 3 5 0 1 2 3 4 0 1 0 3 4 3 5]';
j = [0 0 0 0 1 1 1 1 1 2 2 2 2 2 3 3 4 4 5 6 6]';
h = [5.20094e-1 8.50895e-2 -1.08374 -2.89555e-1 2.22531e-1 9.99115e-1 ...
     1.88797 1.26613 1.20573e-1 -2.81378e-1 -9.06851e-1 -7.72479e-1 ...
     -4.89837e-1 -2.57040e-1 1.61913e-1 2.57399e-1 -3.25372e-2  ...
     6.98452e-2 8.72102e-3 -4.35673e-3 -5.93264e-4]';
H = sparse(i+1,j+1,h);

mu_1 = exp(rho * ((1/T - 1).^(0:5)) * (H * ((rho - 1).^(0:6)')));

mu = 1e-6 * mu_0 * mu_1;
